"use strict";const{app:app,BrowserWindow:BrowserWindow,ipcMain:ipcMain,protocol:protocol}=require("electron"),url=require("url"),path=require("path"),Store=require("electron-store");let win,loginFlow,store=new Store({name:"config",defaults:{windowBounds:{width:1e3,height:700,x:0,y:0},tableColumns:{description:!0,url:!0,created:!1,modified:!1},loginCredentials:{server:"",username:"",password:""},tags:null}});function createWindow(){let{x:e,y:o,width:n,height:r}=store.get("windowBounds");function i(){store.set("windowBounds",win.getBounds())}(win=new BrowserWindow({show:!1,titleBarStyle:"hidden",x:e,y:o,width:n,height:r,minWidth:460,minHeight:396,backgroundColor:"#fff",icon:path.join(__dirname,"../assets/icon/Icon.icns")})).setSheetOffset(24),win.loadURL(url.format({pathname:path.join(__dirname,"../html/app.html"),protocol:"file:",slashes:!0})),win.once("ready-to-show",()=>{win.show()}),win.on("resize",i),win.on("move",i),win.on("closed",()=>{app.quit()}),require("./app-menu.min"),require("./context-menu.min"),require("./tags-menu.min"),protocol.registerFileProtocol("nc",(e,o)=>{const n=e.url.split("&"),r=n[1].replace("user:",""),i=n[2].replace("password:","");store.set("loginCredentials.username",r),store.set("loginCredentials.password",i),loginFlow.close(),win.webContents.send("close-login-modal","close-login-modal"),win.reload()},e=>{e&&console.error("Failed to register protocol")})}app.on("ready",createWindow),ipcMain.on("refresh",(e,o)=>{win.webContents.send("refresh-bookmarks","refresh")}),ipcMain.on("reload",(e,o)=>{console.log("reload"),win.reload()}),ipcMain.on("loginflow",(e,o)=>{(loginFlow=new BrowserWindow({width:800,height:600,resizable:!1,show:!1,titleBarStyle:"hidden",backgroundColor:"#0082c9",webPreferences:{nodeIntegration:!1}})).loadURL(o+"/index.php/login/flow",{userAgent:"Nextcloud Bookmark Manager - Macintosh",extraHeaders:"OCS-APIRequest: true"}),loginFlow.once("ready-to-show",()=>{loginFlow.show()})});
//# sourceMappingURL=maps/main.min.js.map
