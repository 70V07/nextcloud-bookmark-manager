{"version":3,"sources":["main.js"],"names":["app","BrowserWindow","ipcMain","protocol","require","url","path","Store","getAvailableBrowsers","win","loginFlow","store","name","defaults","windowBounds","width","height","x","y","tableColumns","description","created","modified","loginCredentials","server","username","password","tags","browsers","createWindow","get","saveWindowBounds","set","getBounds","show","titleBarStyle","minWidth","minHeight","backgroundColor","icon","join","__dirname","setSheetOffset","loadURL","format","pathname","slashes","once","on","quit","browserList","results","browser","push","registerFileProtocol","request","callback","split","user","replace","pass","close","webContents","send","reload","error","console","event","message","resizable","webPreferences","nodeIntegration","userAgent","extraHeaders"],"mappings":"AAAA,aAEA,MAAMA,IAACA,IAAGC,cAAEA,cAAaC,QAAEA,QAAOC,SAAEA,UAAYC,QAAQ,YAClDC,IAAMD,QAAQ,OACdE,KAAOF,QAAQ,QACfG,MAAQH,QAAQ,kBAEhBI,qBAAuBJ,QAAQ,6BAA6BI,qBAElE,IAAIC,IACHC,UAIGC,MAAQ,IAAIJ,MAAM,CACrBK,KAAM,SACNC,SAAU,CAETC,aAAc,CACbC,MAAO,IACPC,OAAQ,IACRC,EAAG,EACHC,EAAG,GAGJC,aAAc,CAEbC,aAAa,EACbf,KAAK,EACLgB,SAAS,EACTC,UAAU,GAGXC,iBAAkB,CAEjBC,OAAQ,GACRC,SAAU,GACVC,SAAU,IAGXC,KAAM,KAENC,SAAU,QAMZ,SAASC,eAER,IAAIZ,EAAEA,EAACC,EAAEA,EAACH,MAAEA,EAAKC,OAAEA,GAAWL,MAAMmB,IAAI,gBAiBxC,SAASC,IAERpB,MAAMqB,IAAI,eAAgBvB,IAAIwB,cAjB/BxB,IAAM,IAAIR,cAAc,CACvBiC,MAAM,EACNC,cAAe,SACflB,EAAGA,EACHC,EAAGA,EACHH,MAAOA,EACPC,OAAQA,EACRoB,SAAU,IACVC,UAAW,IACXC,gBAAiB,OACjBC,KAAMjC,KAAKkC,KAAKC,UAAW,+BAGxBC,eAAgB,IAOpBjC,IAAIkC,QAAQtC,IAAIuC,OAAQ,CAEvBC,SAAUvC,KAAKkC,KAAKC,UAAW,oBAC/BtC,SAAU,QACV2C,SAAS,KAGVrC,IAAIsC,KAAK,gBAAiB,KAEzBtC,IAAIyB,SAGLzB,IAAIuC,GAAG,SAAUjB,GACjBtB,IAAIuC,GAAG,OAAQjB,GAEftB,IAAIuC,GAAG,SAAU,KAEhBhD,IAAIiD,SAGL7C,QAAS,kBACTA,QAAS,sBACTA,QAAS,mBAETI,qBAAsB,GAAM0C,IAE3B,IAAIC,EAAU,GAEd,IAAM,IAAIC,KAAWF,EAEpBC,EAAQE,KAAM,CAAEzC,KAAQwC,EAAQxC,OAChCD,MAAMqB,IAAI,WAAYmB,KAIxBhD,SAASmD,qBAAqB,KAAM,CAACC,EAASC,KAE7C,MAAMnD,EAAMkD,EAAQlD,IAAIoD,MAAO,KAExBC,EAAOrD,EAAI,GAAGsD,QAAQ,QAAS,IACpCC,EAAOvD,EAAI,GAAGsD,QAAQ,YAAa,IAErChD,MAAMqB,IAAK,4BAA6B0B,GACxC/C,MAAMqB,IAAK,4BAA6B4B,GAExClD,UAAUmD,QAEVpD,IAAIqD,YAAYC,KAAK,oBAAqB,qBAC1CtD,IAAIuD,UAEDC,IAECA,GAAOC,QAAQD,MAAM,iCAI3BjE,IAAIgD,GAAG,QAASnB,cAIhB3B,QAAQ8C,GAAG,UAAW,CAACmB,EAAOC,KAE7B3D,IAAIqD,YAAYC,KAAK,oBAAqB,aAK3C7D,QAAQ8C,GAAG,SAAU,CAACmB,EAAOC,KAE5B3D,IAAIuD,WAKL9D,QAAQ8C,GAAG,YAAa,CAACmB,EAAOC,MAE/B1D,UAAY,IAAIT,cAAc,CAE7Bc,MAAO,IACPC,OAAQ,IACRqD,WAAW,EACXnC,MAAM,EACNC,cAAe,SACfG,gBAAiB,UACjBgC,eAAgB,CACfC,iBAAiB,MAKT5B,QAASyB,EAAU,wBAA0B,CAEtDI,UAAW,yCACXC,aAAc,yBAIf/D,UAAUqC,KAAK,gBAAiB,KAE/BrC,UAAUwB","file":"../main.min.js","sourcesContent":["'use strict'\n\nconst {app, BrowserWindow, ipcMain, protocol} = require('electron')\nconst url = require('url') \nconst path = require('path')\nconst Store = require('electron-store')\n\nconst getAvailableBrowsers = require('detect-installed-browsers').getAvailableBrowsers\n\nlet win,\n\tloginFlow\n\n\n\nlet store = new Store({\n\tname: 'config',\n\tdefaults: {\n\t\t\n\t\twindowBounds: {\n\t\t\twidth: 1000,\n\t\t\theight: 700,\n\t\t\tx: 0,\n\t\t\ty: 0\n\t\t},\n\t\t\n\t\ttableColumns: {\n\t\t\t\n\t\t\tdescription: true,\n\t\t\turl: true,\n\t\t\tcreated: false,\n\t\t\tmodified: false\n\t\t},\n\t\t\n\t\tloginCredentials: {\n\t\t\t\n\t\t\tserver: '',\n\t\t\tusername: '',\n\t\t\tpassword: ''\n\t\t},\n\t\t\n\t\ttags: null,\n\t\t\n\t\tbrowsers: null\n\t}\n})\n\n\n\nfunction createWindow() {\n\t\n\tlet { x, y, width, height } = store.get('windowBounds')\n\t\n\twin = new BrowserWindow({\n\t\tshow: false,\n\t\ttitleBarStyle: 'hidden',\n\t\tx: x,\n\t\ty: y,\n\t\twidth: width,\n\t\theight: height,\n\t\tminWidth: 460,\n\t\tminHeight: 396,\n\t\tbackgroundColor: '#fff',\n\t\ticon: path.join(__dirname, '../assets/icon/Icon.icns')\n\t})\n\t\n\twin.setSheetOffset( 24 )\n\t\n\tfunction saveWindowBounds() {\n\t\t\n\t\tstore.set('windowBounds', win.getBounds())\n\t}\n\t\n\twin.loadURL(url.format ({ \n\t\t\n\t\tpathname: path.join(__dirname, '../html/app.html'), \n\t\tprotocol: 'file:', \n\t\tslashes: true \n\t}))\n\t\n\twin.once('ready-to-show', () => {\n\t\t\n\t\twin.show()\n\t})\n\t\n\twin.on('resize', saveWindowBounds)\n\twin.on('move', saveWindowBounds)\n\t\n\twin.on('closed', () => {\n\t\t\n\t\tapp.quit()\n\t})\n\t\n\trequire( './app-menu.min' )\n\trequire( './context-menu.min' )\n\trequire( './tags-menu.min' )\n\t\n\tgetAvailableBrowsers( {}, ( browserList ) => {\n\t\t\n\t\tlet results = []\n\t\t\n\t\tfor ( let browser of browserList ) {\n\t\t\t\n\t\t\tresults.push( { \"name\": browser.name } )\n\t\t\tstore.set('browsers', results )\n\t\t}\n\t})\n\t\n\tprotocol.registerFileProtocol('nc', (request, callback) => {\n\t\t\n\t\tconst url = request.url.split( '&' )\n\t\t\n\t\tconst \tuser = url[1].replace('user:', ''),\n\t\t\t\tpass = url[2].replace('password:', '')\n\t\t\n\t\tstore.set( 'loginCredentials.username', user )\n\t\tstore.set( 'loginCredentials.password', pass )\n\t\t\n\t\tloginFlow.close()\n\t\t\n\t\twin.webContents.send('close-login-modal', 'close-login-modal')\n\t\twin.reload()\n\t\n\t}, (error) => {\n\t\n\t\tif (error) console.error('Failed to register protocol')\n\t})\n}\n\napp.on('ready', createWindow) \n\n\n\nipcMain.on('refresh', (event, message) => {\n\t\n\twin.webContents.send('refresh-bookmarks', 'refresh')\n})\n\n\n\nipcMain.on('reload', (event, message) => {\n\t\n\twin.reload()\n})\n\n\n\nipcMain.on('loginflow', (event, message) => {\n\t\n\tloginFlow = new BrowserWindow({\n\t\t\n\t\twidth: 800,\n\t\theight: 600,\n\t\tresizable: false,\n\t\tshow: false,\n\t\ttitleBarStyle: 'hidden',\n\t\tbackgroundColor: '#0082c9',\n\t\twebPreferences: {\n\t\t\tnodeIntegration: false\n\t\t}\n\t})\n\t\n\t\n\tloginFlow.loadURL( message + '/index.php/login/flow' , {\n\t\t\n\t\tuserAgent: 'Nextcloud Bookmark Manager - Macintosh',\n\t\textraHeaders: 'OCS-APIRequest: true'\n\t})\n\t\n\t\n\tloginFlow.once('ready-to-show', () => {\n\t\t\n\t\tloginFlow.show()\n\t})\n})\n"]}