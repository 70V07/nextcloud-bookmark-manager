{"version":3,"names":[],"mappings":"","sources":["menu-tray.js"],"sourcesContent":["'use strict'\n\nconst {\n\tapp,\n\tBrowserWindow,\n\tipcMain,\n\tMenu,\n\tTray,\n\tshell\n} = require( 'electron' )\n\nconst path \t= require( 'path' )\nconst Store\t= require( 'electron-store' )\nconst store = new Store()\n\nlet trayIcon \t\t= null,\n\tbookmarks \t\t= new Store( {name: 'bookmarks'} )\n\n\n\nipcMain.on( 'tray-menu', (event) => {\n\t\n\tif( trayIcon !== null ) trayIcon.destroy()\n\t\n\tlet bookmarkdata \t= bookmarks.get( 'data' ),\n\t\tfolders \t\t= store.get( 'folders' )\n\t\n\tfolders.sort((a,b) => (a.text > b.text) ? 1 : ((b.text > a.text) ? -1 : 0))\n\t\n\tconst \ticonName \t= '../assets/png/iconTemplate.png',\n\t\t\tfolderName \t= '../assets/png/folderTemplate.png',\n\t\t\ticonPath \t= path.join( __dirname , iconName ),\n\t\t\tfolderPath \t= path.join( __dirname , folderName )\n\t\n\ttrayIcon = new Tray( iconPath )\n\t\n\tconst trayMenuTemplate = []\n\t\n\tfor( let folder of folders ) {\n\t\t\n\t\ttrayMenuTemplate.push({\n\t\t\tlabel: folder.text,\n\t\t\tid: folder.id,\n\t\t\ticon: folderPath,\n\t\t\tsubmenu: []\n\t\t})\n\t}\n\t\n\ttrayMenuTemplate.push({ type: 'separator' })\n\t\n\tfor( let bookmark of bookmarkdata ) {\n\t\t\n\t\tfor( let id of bookmark.folders  ) {\n\t\t\t\n\t\t\tif( id === -1 ) {\n\t\t\t\t\n\t\t\t\ttrayMenuTemplate.push({\n\t\t\t\t\tlabel: bookmark.title,\n\t\t\t\t\ticon: iconPath,\n\t\t\t\t\tclick () {\n\t\t\t\t\t\tshell.openExternal( bookmark.url )\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t\n\t\t\t} else {\n\t\t\t\t\n\t\t\t\tlet submenu = trayMenuTemplate.find(x => x.id === id).submenu\n\t\t\t\t\n\t\t\t\tsubmenu.push({\n\t\t\t\t\tlabel: bookmark.title,\n\t\t\t\t\ticon: iconPath,\n\t\t\t\t\tclick () {\n\t\t\t\t\t\tshell.openExternal( bookmark.url )\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t}\n\t\n\tconst trayMenu = Menu.buildFromTemplate( trayMenuTemplate )\n\ttrayIcon.setContextMenu( trayMenu )\n\t\n\ttrayIcon.on('drop-text', (event, text) => {\n\t\t\n\t\tlet win = BrowserWindow.fromId(1)\n\t\twin.show()\n\t\twin.webContents.send( 'url-from-browser', text )\n\t})\n})\n"],"file":"../menu-tray.min.js"}