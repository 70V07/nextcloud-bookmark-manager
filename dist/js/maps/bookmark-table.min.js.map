{"version":3,"names":[],"mappings":"","sources":["bookmark-table.js"],"sourcesContent":["'use strict'\n\nconst i18n\t\t= require( './i18n.min' )\n\nconst fs \t\t= require( 'fs-extra' )\nconst path \t\t= require('path')\nconst Store\t\t= require( 'electron-store' )\nconst store\t\t= new Store()\nconst $\t\t\t= require( 'jquery' )\nconst dt\t\t= require( 'datatables.net' )( window, $ )\nconst keytable\t= require( 'datatables.net-keytable' )( window, $ )\n\nrequire( 'datatables.net-responsive' )( window, $ )\n\n\n\n$.fn.dataTable.render.ellipsis = function ( cutoff, wordbreak, escapeHtml ) {\n\t\n\tvar esc = function ( t ) {\n\t\treturn t\n\t\t.replace( /&/g, '&amp;' )\n\t\t.replace( /</g, '&lt;' )\n\t\t.replace( />/g, '&gt;' )\n\t\t.replace( /\"/g, '&quot;' )\n\t}\n\n\treturn function ( d, type, row ) {\n\t\n\t\tif ( type !== 'display' ) {\n\t\t\t\n\t\t\treturn d\n\t\t}\n\t\n\t\tif ( typeof d !== 'number' && typeof d !== 'string' ) {\n\t\t\t\n\t\t\treturn d\n\t\t}\n\t\n\t\td = d.toString()\n\t\n\t\tif ( d.length <= cutoff ) {\n\t\t\t\n\t\t\treturn d\n\t\t}\n\t\n\t\tvar shortened = d.substr(0, cutoff-1)\n\t\n\t\tif ( wordbreak ) {\n\t\t\t\n\t\t\tshortened = shortened.replace(/\\s([^\\s]*)$/, '')\n\t\t}\n\t\n\t\tif ( escapeHtml ) {\n\t\t\t\n\t\t\tshortened = esc( shortened )\n\t\t}\n\t\n\t\treturn '<span class=\"ellipsis\" title=\"'+esc(d)+'\">'+shortened+'&#8230;</span>'\n\t}\n}\n\n\n\nmodule.exports.bookmarkTable = $('#bookmarks').DataTable({\n\t\n\tresponsive: true,\n\tresponsive: {\n\t\tdetails: false\n\t},\n\tkeys: {\n\t\ttabIndex: 1,\n\t\tblurable: true,\n\t\tkeys: [ \t32, // space\n\t\t\t\t\t38, // up\n\t\t\t\t\t40  // down\n\t\t]\n\t},\n\tscrollY: \t'calc(100vh - 59px)', // window height - header - footer\n\tpaging: \tfalse,\n\tdom: 'ltipr', // hide default search field\n\trowId:\n\t\tfunction(column) {\n\t\t\treturn 'row_' + column[0] // create unique row id form json ids\n\t\t},\n\t'order': [[ 5, 'desc' ]],\n\tcolumnDefs:\n\t\t[\n\t\t\t{\n\t\t\t\ttitle: 'ID',\n\t\t\t\ttargets: [ 0 ],\n\t\t\t\tvisible: false,\n\t\t\t\tsearchable: false\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: `<button id=\"toggle-info-panel\" title=\"${i18n.t('bookmarktable:header.details', 'Details')}\"></button>`,\n\t\t\t\tresponsivePriority: 1,\n\t\t\t\ttargets: [ 1 ],\n\t\t\t\tclassName: 'details-control',\n\t\t\t\torderable: false,\n\t\t\t\tdata: null,\n\t\t\t\tdefaultContent: '',\n\t\t\t\twidth: '35px'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: i18n.t('bookmarktable:header.title', 'Title'),\n\t\t\t\trender: $.fn.dataTable.render.ellipsis( 45, true, true ),\n\t\t\t\tresponsivePriority: 1,\n\t\t\t\ttargets: [ 2 ],\n\t\t\t\twidth: '99%'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: i18n.t('bookmarktable:header.description', 'Description'),\n\t\t\t\trender: $.fn.dataTable.render.ellipsis( 45, true, true ),\n\t\t\t\tresponsivePriority: 10000,\n\t\t\t\ttargets: [ 3 ],\n\t\t\t\tvisible: store.get('tableColumns.description')\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: i18n.t('bookmarktable:header.url', 'Url'),\n\t\t\t\trender: $.fn.dataTable.render.ellipsis( 45, true, true ),\n\t\t\t\tresponsivePriority: 10001,\n\t\t\t\ttargets: [ 4 ],\n\t\t\t\tvisible: store.get('tableColumns.url')\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'unix added',\n\t\t\t\ttargets: [ 5 ],\n\t\t\t\tvisible: false\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: i18n.t('bookmarktable:header.created', 'Created'),\n\t\t\t\tresponsivePriority: 10003,\n\t\t\t\ttargets: [ 6 ],\n\t\t\t\tvisible: store.get('tableColumns.created'),\n\t\t\t\tsearchable: false,\n\t\t\t\tiDataSort: 5\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'unix modified',\n\t\t\t\ttargets: [ 7 ],\n\t\t\t\tvisible: false\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: i18n.t('bookmarktable:header.modified', 'Modified'),\n\t\t\t\tresponsivePriority: 10002,\n\t\t\t\ttargets: [ 8 ],\n\t\t\t\tvisible: store.get('tableColumns.modified'),\n\t\t\t\tsearchable: false,\n\t\t\t\tiDataSort: 7\n\t\t\t},\n\t\t\t{\n\t\t\t\ttargets: [ 6, 8 ],\n\t\t\t\tclassName: 'date-column',\n\t\t\t\twidth: '135px'\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'folder id',\n\t\t\t\ttargets: [ 9 ],\n\t\t\t\tvisible: false\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: i18n.t('bookmarktable:header.folders', 'Folders'),\n\t\t\t\tclassName: 'folders-column',\n\t\t\t\tresponsivePriority: 10004,\n\t\t\t\ttargets: [ 10 ],\n\t\t\t\tvisible: store.get('tableColumns.folders'),\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: i18n.t('bookmarktable:header.tags', 'Tags'),\n\t\t\t\tclassName: 'tags-column padded-right',\n\t\t\t\tresponsivePriority: 2,\n\t\t\t\ttargets: [ 11 ],\n\t\t\t\tvisible: store.get('tableColumns.tags'),\n\t\t\t\twidth: '50px',\n\t\t\t}\n\t\t],\n\t\n\tlanguage: {\n\t\temptyTable: i18n.t('bookmarktable:footer.nodata', 'No data available'),\n\t\tzeroRecords: i18n.t('bookmarktable:footer.zero', '<span class=\"text\">No matching Bookmarks were found</span>'),\n\t\tinfo: i18n.t('bookmarktable:footer.info', '<span class=\"text\">Showing </span><b>_TOTAL_</b><span class=\"text\"> Bookmarks</span>'),\n\t\tinfoEmpty: i18n.t('bookmarktable:footer.empty', 'Showing <b>0</b><span class=\"text\"> to 0 of 0 Bookmarks</span>'),\n\t\tinfoFiltered: i18n.t('bookmarktable:footer.filtered', '<span class=\"filtered\">(filtered from _MAX_ Bookmarks)</span>')\n\t}\n})\n\n\n\nmodule.exports.detailsTable = function( data ) {\n\t\n\tlet desc = ( data[3] == '' ? '⋯' : data[3] )\n\t\n\treturn `<div class=\"details-panel\">\n\t<div class=\"inner\">\n\t\t<div class=\"row\">\n\t\t\t<div class=\"label\">${i18n.t('bookmarktable:header.url', 'Url')}:</div>\n\t\t\t<div class=\"value nowrap\"><a id=\"url_${data[0]}\" href=\"${data[4]}\" title=\"${data[2]}\"><img class=\"favicon\" src=\"${getFavicon(data[0])}\" width=\"16\" height=\"16\">&nbsp;${data[4]}</a></div>\n\t\t</div>\n\t\t\n\t\t<div class=\"row\">\n\t\t\t<div class=\"label\">${i18n.t('bookmarktable:header.title', 'Title')}:</div>\n\t\t\t<div class=\"value wrap\">${data[2]}</div>\n\t\t</div>\n\t\t\n\t\t<div class=\"row\">\n\t\t\t<div class=\"label\">${i18n.t('bookmarktable:header.description', 'Description')}:</div>\n\t\t\t<div class=\"value wrap\">${desc}</div>\n\t\t</div>\n\t\t\n\t\t<div class=\"row\">\n\t\t\t<div class=\"label\">${i18n.t('bookmarktable:header.created', 'Created')}:</div>\n\t\t\t<div class=\"value\">${data[6]}</div>\n\t\t</div>\n\t\t\n\t\t<div class=\"row\">\n\t\t\t<div class=\"label\">${i18n.t('bookmarktable:header.modified', 'Modified')}:</div>\n\t\t\t<div class=\"value\">${data[8]}</div>\n\t\t</div>\n\t\t\n\t\t<div class=\"row\">\n\t\t\t<div class=\"label\">${i18n.t('bookmarktable:header.folders', 'Folders')}:</div>\n\t\t\t<div class=\"value\">${data[10]}</div>\n\t\t</div>\n\t\t\n\t\t<div class=\"row\">\n\t\t\t<div class=\"label\">${i18n.t('bookmarktable:header.tags', 'Tags')}:</div>\n\t\t\t<div class=\"value\">${data[11]}</div>\n\t\t</div>\n\t\t\n\t\t<div class=\"buttons\">\n\t\t\t<button class=\"info-edit ui-button small\" data-id=\"${data[0]}\">${i18n.t('menu:bookmarks.edit', 'Edit Bookmark…')}</button>\n\t\t\t<button class=\"info-delete ui-button small\" data-id=\"${data[0]}\">${i18n.t('menu:bookmarks.delete', 'Delete Bookmark…')}</button>\n\t\t</div>\n\t</div>\n</div>`\n}\n\n\n\nfunction getFavicon( id ) {\n\t\n\tlet dir = store.get( 'dirPath' ),\n\t\tres = ( matchMedia( '(-webkit-min-device-pixel-ratio: 2), (min-device-pixel-ratio: 2), (min-resolution: 192dpi)' ).matches ? '@2x' : '' )\n\t\n\tif( fs.pathExistsSync( `${dir}/favicons/${id}${res}.png` ) ) {\n\t\t\n\t\treturn `${dir}/favicons/${id}${res}.png`\n\t\t\n\t} else {\n\t\t\n\t\tlet theme = ( $('html').attr('data-theme') === 'dark' ) ? 'dark-'  : ''\n\t\t\n\t\treturn path.join(__dirname, `../assets/png/${theme}iconTemplate${res}.png`) \n\t}\n}\n"],"file":"../bookmark-table.min.js"}