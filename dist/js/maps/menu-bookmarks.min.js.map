{"version":3,"names":[],"mappings":"","sources":["menu-bookmarks.js"],"sourcesContent":["'use strict'\n\nconst electron = require( 'electron' )\nconst {shell, app, clipboard} = require( 'electron' )\nconst dialog = require( 'electron' ).dialog\nconst BrowserWindow = electron.BrowserWindow\nconst Menu = electron.Menu\nconst MenuItem = electron.MenuItem\nconst ipc = electron.ipcMain\n\nconst Store = require( 'electron-store' )\nconst store = new Store()\n\nconst applescript = require( 'applescript' )\n\n//note(dgmid): decodeentities\n\nfunction decodeEntities( str ) {\n    \n    return \tString(str)\n    \t\t.replace(/&lt;/g, '<')\n    \t\t.replace(/&gt;/g, '>')\n}\n\n\n\nipc.on('show-bookmark-menu', ( event, message ) => {\n\t\n\tlet title = decodeEntities( message[1] )\n\t\n\tconst bookmarkMenuTemplate = [\n\t\t{\n\t\t\tlabel: `Open ${title} in Default Browser`,\n\t\t\tclick () { require('electron').shell.openExternal( message[3] ) }\n\t\t},\n\t\t{\n\t\t\tlabel: `Open ${title} with…`,\n\t\t\tsubmenu: []\n\t\t},\n\t\t{\n\t\t\tlabel: `Copy ${title} url to Clipboard`,\n\t\t\tclick () { clipboard.writeText(message[3], title) }\t\n\t\t},\n\t\t{\n\t\t\ttype: 'separator'\n\t\t},\n\t\t{\n\t\t\tlabel: `Edit ${title} Bookmark…`,\n\t\t\tclick (item, focusedWindow) { if(focusedWindow) focusedWindow.webContents.send('edit-bookmark', message) }\n\t\t},\n\t\t{\n\t\t\tlabel: `Delete ${title} Bookmark…`,\n\t\t\tclick (item, focusedWindow) { if(focusedWindow) focusedWindow.webContents.send('delete-bookmark', message) }\n\t\t\t\n\t\t},\n\t]\n\t\n\tconst browsers = store.get('browsers')\n\t\n\tfor (let i = 0, len = browsers.length; i < len; i++) {\n\t\t\n\t\tlet theBrowser = browsers[i]['name']\n\t\t\n\t\tlet launchScript =\n\t\t\n\t\t`tell application \"${theBrowser}\"\n\t\t\topen location \"${message[3]}\"\n\t\tend tell\n\t\ttell application \"System Events\"\n\t\t\ttell application process \"${theBrowser}\"\n\t\t\tset frontmost to true\n\t\t\tend tell\n\t\tend tell`\n\t\t\n\t\tbookmarkMenuTemplate[1].submenu.push({\n\t\t\t\tlabel: theBrowser,\n\t\t\t\tclick () {\n\t\t\t\t\t\n\t\t\t\t\tapplescript.execString(launchScript, function(err, rtn) {\n\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tdialog.showErrorBox(\n\t\t\t\t\t\t\t\t`Error launching: ${theBrowser}`,\n\t\t\t\t\t\t\t\t`the url ${message[3]} could not be opened`\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tconsole.log( err )\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}\n\t\t)\n\t}\n\t\n\tconst bookmarkMenu = Menu.buildFromTemplate( bookmarkMenuTemplate )\n\t\n\tconst win = BrowserWindow.fromWebContents( event.sender )\n\tbookmarkMenu.popup( win )\n})\n"],"file":"../menu-bookmarks.min.js"}